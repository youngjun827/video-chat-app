{"ast":null,"code":"import _regeneratorRuntime from\"/Users/youngjun827/dev/discord-app/discord-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/youngjun827/dev/discord-app/discord-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from\"axios\";import{logout}from\"./shared/utils/auth\";// 6. The API exists in the \"apiClient\". This means all activities between the frontend and backend environment go through here. So, naturally, THROUGH the apiClient, the userDetails are passed to the server. **Please scroll the page down to see step 7.\nvar apiClient=axios.create({baseURL:\"http://localhost:5002/api\",timeout:1000});apiClient.interceptors.request.use(function(config){var userDetails=localStorage.getItem(\"user\");if(userDetails){var token=JSON.parse(userDetails).token;config.headers.Authorization=\"Bearer \".concat(token);}return config;},function(err){return Promise.reject(err);});// public routes\n// 7. Here, the \"login\" function tries to POST our userDetails (data) to the \"/auth/login\" route. To check the route, we must go to our backend environment. **Please go to the \"authRoutes\" file in the backend folder to view the routing process.\nexport var login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return apiClient.post(\"/auth/login\",data);case 3:return _context.abrupt(\"return\",_context.sent);case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);return _context.abrupt(\"return\",{error:true,exception:_context.t0});case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return function login(_x){return _ref.apply(this,arguments);};}();export var register=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return apiClient.post(\"/auth/register\",data);case 3:return _context2.abrupt(\"return\",_context2.sent);case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);return _context2.abrupt(\"return\",{error:true,exception:_context2.t0});case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function register(_x2){return _ref2.apply(this,arguments);};}();// secure routes\nexport var sendFriendInvitation=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(data){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return apiClient.post(\"/friend-invitation/invite\",data);case 3:return _context3.abrupt(\"return\",_context3.sent);case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);checkResponseCode(_context3.t0);return _context3.abrupt(\"return\",{error:true,exception:_context3.t0});case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,6]]);}));return function sendFriendInvitation(_x3){return _ref3.apply(this,arguments);};}();export var acceptFriendInvitation=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(data){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return apiClient.post(\"/friend-invitation/accept\",data);case 3:return _context4.abrupt(\"return\",_context4.sent);case 6:_context4.prev=6;_context4.t0=_context4[\"catch\"](0);checkResponseCode(_context4.t0);return _context4.abrupt(\"return\",{error:true,exception:_context4.t0});case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[0,6]]);}));return function acceptFriendInvitation(_x4){return _ref4.apply(this,arguments);};}();export var rejectFriendInvitation=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(data){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return apiClient.post(\"/friend-invitation/reject\",data);case 3:return _context5.abrupt(\"return\",_context5.sent);case 6:_context5.prev=6;_context5.t0=_context5[\"catch\"](0);checkResponseCode(_context5.t0);return _context5.abrupt(\"return\",{error:true,exception:_context5.t0});case 10:case\"end\":return _context5.stop();}}},_callee5,null,[[0,6]]);}));return function rejectFriendInvitation(_x5){return _ref5.apply(this,arguments);};}();var checkResponseCode=function checkResponseCode(exception){var _exception$response;var responseCode=exception===null||exception===void 0?void 0:(_exception$response=exception.response)===null||_exception$response===void 0?void 0:_exception$response.status;if(responseCode){(responseCode===401||responseCode===403)&&logout();}};","map":{"version":3,"names":["axios","logout","apiClient","create","baseURL","timeout","interceptors","request","use","config","userDetails","localStorage","getItem","token","JSON","parse","headers","Authorization","err","Promise","reject","login","data","post","error","exception","register","sendFriendInvitation","checkResponseCode","acceptFriendInvitation","rejectFriendInvitation","responseCode","response","status"],"sources":["/Users/youngjun827/dev/discord-app/discord-frontend/src/api.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { logout } from \"./shared/utils/auth\";\r\n\r\n// 6. The API exists in the \"apiClient\". This means all activities between the frontend and backend environment go through here. So, naturally, THROUGH the apiClient, the userDetails are passed to the server. **Please scroll the page down to see step 7.\r\nconst apiClient = axios.create({\r\n  baseURL: \"http://localhost:5002/api\",\r\n  timeout: 1000,\r\n});\r\n\r\napiClient.interceptors.request.use(\r\n  (config) => {\r\n    const userDetails = localStorage.getItem(\"user\");\r\n\r\n    if (userDetails) {\r\n      const token = JSON.parse(userDetails).token;\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n\r\n    return config;\r\n  },\r\n  (err) => {\r\n    return Promise.reject(err);\r\n  }\r\n);\r\n\r\n// public routes\r\n\r\n// 7. Here, the \"login\" function tries to POST our userDetails (data) to the \"/auth/login\" route. To check the route, we must go to our backend environment. **Please go to the \"authRoutes\" file in the backend folder to view the routing process.\r\nexport const login = async (data) => {\r\n  try {\r\n    return await apiClient.post(\"/auth/login\", data);\r\n  } catch (exception) {\r\n    return {\r\n      error: true,\r\n      exception,\r\n    };\r\n  }\r\n};\r\n\r\nexport const register = async (data) => {\r\n  try {\r\n    return await apiClient.post(\"/auth/register\", data);\r\n  } catch (exception) {\r\n    return {\r\n      error: true,\r\n      exception,\r\n    };\r\n  }\r\n};\r\n\r\n// secure routes\r\nexport const sendFriendInvitation = async (data) => {\r\n  try {\r\n    return await apiClient.post(\"/friend-invitation/invite\", data);\r\n  } catch (exception) {\r\n    checkResponseCode(exception);\r\n    return {\r\n      error: true,\r\n      exception,\r\n    };\r\n  }\r\n};\r\n\r\nexport const acceptFriendInvitation = async (data) => {\r\n  try {\r\n    return await apiClient.post(\"/friend-invitation/accept\", data);\r\n  } catch (exception) {\r\n    checkResponseCode(exception);\r\n    return {\r\n      error: true,\r\n      exception,\r\n    };\r\n  }\r\n};\r\n\r\nexport const rejectFriendInvitation = async (data) => {\r\n  try {\r\n    return await apiClient.post(\"/friend-invitation/reject\", data);\r\n  } catch (exception) {\r\n    checkResponseCode(exception);\r\n    return {\r\n      error: true,\r\n      exception,\r\n    };\r\n  }\r\n};\r\n\r\nconst checkResponseCode = (exception) => {\r\n  const responseCode = exception?.response?.status;\r\n\r\n  if (responseCode) {\r\n    (responseCode === 401 || responseCode === 403) && logout();\r\n  }\r\n};\r\n"],"mappings":"kSAAA,MAAOA,MAAP,KAAkB,OAAlB,CACA,OAASC,MAAT,KAAuB,qBAAvB,CAEA;AACA,GAAMC,UAAS,CAAGF,KAAK,CAACG,MAAN,CAAa,CAC7BC,OAAO,CAAE,2BADoB,CAE7BC,OAAO,CAAE,IAFoB,CAAb,CAAlB,CAKAH,SAAS,CAACI,YAAV,CAAuBC,OAAvB,CAA+BC,GAA/B,CACE,SAACC,MAAD,CAAY,CACV,GAAMC,YAAW,CAAGC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAApB,CAEA,GAAIF,WAAJ,CAAiB,CACf,GAAMG,MAAK,CAAGC,IAAI,CAACC,KAAL,CAAWL,WAAX,EAAwBG,KAAtC,CACAJ,MAAM,CAACO,OAAP,CAAeC,aAAf,kBAAyCJ,KAAzC,EACD,CAED,MAAOJ,OAAP,CACD,CAVH,CAWE,SAACS,GAAD,CAAS,CACP,MAAOC,QAAO,CAACC,MAAR,CAAeF,GAAf,CAAP,CACD,CAbH,EAgBA;AAEA;AACA,MAAO,IAAMG,MAAK,4FAAG,iBAAOC,IAAP,0JAEJpB,UAAS,CAACqB,IAAV,CAAe,aAAf,CAA8BD,IAA9B,CAFI,+IAIV,CACLE,KAAK,CAAE,IADF,CAELC,SAAS,YAFJ,CAJU,qEAAH,kBAALJ,MAAK,4CAAX,CAWP,MAAO,IAAMK,SAAQ,6FAAG,kBAAOJ,IAAP,gKAEPpB,UAAS,CAACqB,IAAV,CAAe,gBAAf,CAAiCD,IAAjC,CAFO,qJAIb,CACLE,KAAK,CAAE,IADF,CAELC,SAAS,aAFJ,CAJa,uEAAH,kBAARC,SAAQ,8CAAd,CAWP;AACA,MAAO,IAAMC,qBAAoB,6FAAG,kBAAOL,IAAP,gKAEnBpB,UAAS,CAACqB,IAAV,CAAe,2BAAf,CAA4CD,IAA5C,CAFmB,oHAIhCM,iBAAiB,cAAjB,CAJgC,iCAKzB,CACLJ,KAAK,CAAE,IADF,CAELC,SAAS,aAFJ,CALyB,wEAAH,kBAApBE,qBAAoB,8CAA1B,CAYP,MAAO,IAAME,uBAAsB,6FAAG,kBAAOP,IAAP,gKAErBpB,UAAS,CAACqB,IAAV,CAAe,2BAAf,CAA4CD,IAA5C,CAFqB,oHAIlCM,iBAAiB,cAAjB,CAJkC,iCAK3B,CACLJ,KAAK,CAAE,IADF,CAELC,SAAS,aAFJ,CAL2B,wEAAH,kBAAtBI,uBAAsB,8CAA5B,CAYP,MAAO,IAAMC,uBAAsB,6FAAG,kBAAOR,IAAP,gKAErBpB,UAAS,CAACqB,IAAV,CAAe,2BAAf,CAA4CD,IAA5C,CAFqB,oHAIlCM,iBAAiB,cAAjB,CAJkC,iCAK3B,CACLJ,KAAK,CAAE,IADF,CAELC,SAAS,aAFJ,CAL2B,wEAAH,kBAAtBK,uBAAsB,8CAA5B,CAYP,GAAMF,kBAAiB,CAAG,QAApBA,kBAAoB,CAACH,SAAD,CAAe,yBACvC,GAAMM,aAAY,CAAGN,SAAH,SAAGA,SAAH,sCAAGA,SAAS,CAAEO,QAAd,8CAAG,oBAAqBC,MAA1C,CAEA,GAAIF,YAAJ,CAAkB,CAChB,CAACA,YAAY,GAAK,GAAjB,EAAwBA,YAAY,GAAK,GAA1C,GAAkD9B,MAAM,EAAxD,CACD,CACF,CAND"},"metadata":{},"sourceType":"module"}